(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[277],{6499:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/payments/add",function(){return s(5858)}])},1365:function(e,t,s){"use strict";s.d(t,{I:function(){return i},Z:function(){return a}});var n=s(5893);function i(e,t){return{...e,...t}}function a(e){let{title:t,icon:s,children:i,className:a,hidden:l=!0,mainText:r="OK",mainColors:o,mainOnClick:c,secondaryText:d="Cancel",secondaryShow:m=!0,secondaryColors:x,secondaryOnClick:u}=e,h={checkmark:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"48",viewBox:"0 96 960 960",width:"48",children:(0,n.jsx)("path",{className:"fill-green-300",d:"m421 667-98-98q-9-9-22-9t-23 10q-9 9-9 22t9 22l122 123q9 9 21 9t21-9l239-239q10-10 10-23t-10-23q-10-9-23.5-8.5T635 453L421 667Zm59 309q-82 0-155-31.5t-127.5-86Q143 804 111.5 731T80 576q0-83 31.5-156t86-127Q252 239 325 207.5T480 176q83 0 156 31.5T763 293q54 54 85.5 127T880 576q0 82-31.5 155T763 858.5q-54 54.5-127 86T480 976Z"})}),error:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"48",viewBox:"0 96 960 960",width:"48",children:(0,n.jsx)("path",{className:"fill-red-300",d:"M479.754 801Q504 801 519.5 786.246q15.5-14.755 15.5-39Q535 723 519.746 707q-15.255-16-39.5-16Q456 691 440.5 706.982 425 722.965 425 747.211q0 24.245 15.254 39.017Q455.509 801 479.754 801Zm3.421-177Q503 624 516.5 610.375 530 596.75 530 577V401q0-19.75-13.675-33.375Q502.649 354 482.825 354 463 354 449.5 367.625 436 381.25 436 401v176q0 19.75 13.675 33.375Q463.351 624 483.175 624Zm-2.771 377q-88.872 0-166.125-33.084-77.254-33.083-135.183-91.012-57.929-57.929-91.012-135.119Q55 664.594 55 575.638q0-88.957 33.084-166.285 33.083-77.328 90.855-134.809 57.772-57.482 135.036-91.013Q391.238 150 480.279 150q89.04 0 166.486 33.454 77.446 33.453 134.853 90.802 57.407 57.349 90.895 134.877Q906 486.66 906 575.734q0 89.01-33.531 166.247-33.531 77.237-91.013 134.86-57.481 57.623-134.831 90.891Q569.276 1001 480.404 1001Z"})}),warning:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"48",viewBox:"0 96 960 960",width:"48",children:(0,n.jsx)("path",{className:"fill-yellow-300",d:"M100 949q-14.483 0-24.98-6.925Q64.521 935.15 59 925q-6.167-9.6-6.583-22.381Q52 889.839 59 877l380-656q7-12 18.103-17.5 11.102-5.5 23-5.5Q492 198 503 203.5q11 5.5 18 17.5l380 656q7 12.839 6.583 25.619Q907.167 915.4 901 925q-5.696 9.75-16.106 16.875Q874.483 949 860 949H100Zm384.175-132q13.4 0 23.613-10.388Q518 796.224 518 782.825q0-13.4-10.388-23.112Q497.224 750 483.825 750q-13.4 0-23.613 9.888Q450 769.776 450 783.175q0 13.4 10.388 23.612Q470.776 817 484.175 817Zm0-109q12.825 0 21.325-8.625T514 678V522q0-12.75-8.675-21.375-8.676-8.625-21.5-8.625-12.825 0-21.325 8.625T454 522v156q0 12.75 8.675 21.375 8.676 8.625 21.5 8.625Z"})}),notif:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"48",viewBox:"0 96 960 960",width:"48",children:(0,n.jsx)("path",{className:"fill-blue-300",d:"M480.281 621Q494 621 503 611.8q9-9.2 9-22.8V450q0-12.6-9.281-21.8-9.28-9.2-23-9.2-13.719 0-22.219 9.2-8.5 9.2-8.5 21.8v139q0 13.6 8.993 22.8 8.993 9.2 22.288 9.2Zm-.299 107q14.593 0 25.806-10.982Q517 706.035 517 691.518 517 677 505.805 666t-25.787-11q-14.593 0-25.806 11.079Q443 677.158 443 691.579T454.195 717q11.195 11 25.787 11ZM165.44 878q-21.19 0-34.815-13.675-13.625-13.676-13.625-34Q117 810 130.625 796.5 144.25 783 165 783h45V505q0-92.085 53.5-167.542Q317 262 407 241.583V218q0-30.5 21.223-50.75T479.765 147q30.318 0 51.777 20.25Q553 187.5 553 218v23.583Q644 262 698 337.458 752 412.915 752 505v278h44q19.625 0 33.812 13.675 14.188 13.676 14.188 34Q844 851 829.812 864.5 815.625 878 796 878H165.44Zm315.06 123q-35.45 0-61.975-25.85T392 913h177q0 37-26.231 62.5-26.232 25.5-62.269 25.5Z"})})};return(0,n.jsxs)("div",{className:"relative z-10 "+a,"aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",hidden:l,children:[(0,n.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"}),(0,n.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,n.jsx)("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:(0,n.jsxs)("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg",children:[(0,n.jsx)("div",{className:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4",children:(0,n.jsxs)("div",{className:"sm:flex sm:items-start",children:[(0,n.jsx)("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full sm:mx-0 sm:h-10 sm:w-10",children:s?"string"==typeof s&&h[s]?h[s]:s:null}),(0,n.jsxs)("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left",children:[(0,n.jsx)("h3",{className:"text-base font-semibold leading-6 text-gray-900",id:"modal-title",children:t}),(0,n.jsx)("div",{className:"mt-2",children:(0,n.jsx)("div",{className:"text-sm text-gray-500",children:i})})]})]})}),(0,n.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:[(0,n.jsx)("button",{type:"button",className:"inline-flex w-full justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:opacity-80 sm:ml-3 sm:w-auto "+o,onClick:c,children:r}),(0,n.jsx)("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:opacity-80 sm:mt-0 sm:w-auto "+x,hidden:!m,onClick:u,children:d})]})]})})})]})}},432:function(e){"use strict";e.exports={nric:/[0-9]{2}[0-1][0-9][0-3][0-9]-[0-9]{2}-[0-9]{4}/,passport:/[A-Z0-9]{1,9}/,phone:/\+?[\d ]{1,6}[- ]?[\d ]{1,15}/,dob:/\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])/,email:/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/,amount:/\d+(\.\d{1,2})?/}},5858:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return y}});var n=s(5893),i=s(8804),a=s(7312),l=s(7294),r=s(7536),o=s(1758),c=s(1019),d=s(6650),m=s(5696),x=s(1365),u=s(1163),h=s(8063),p=s.n(h),f=s(432),g=s.n(f);function y(){var e,t;let[s,h]=(0,l.useState)(["Payment to bank:",...p().bank_details,"Fees: ".concat(p().currency).concat(p().registration_fee," per contestant")]),[f,y]=(0,l.useState)(!1),[v,w]=(0,l.useState)(!0),{register:b,handleSubmit:j,formState:{errors:q},watch:N,setValue:Q}=(0,r.cI)(),k=N("proof"),[T,Z]=(0,l.useReducer)(x.I,{}),P=(0,u.useRouter)(),_=async e=>{y(!0),w(!1);let t=e.amount?e.amount.trim():"",s=e.proof?e.proof[0]:null;null!=s&&(0,c.jM)((0,c.iH)(m.db,"payments/".concat(m.I.currentUser.uid)),e=>{let n=function(){let e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",t=new Date().valueOf(),s="";do s=e[t%62]+s,t=Math.floor(t/62);while(t>0);for(let t=0;t<5;t++)s+=e[Math.floor(62*Math.random())];return s}(),i=e.exists()?Object.keys(e.val()).length+1+1e4:10001,a=s.name.split(".").pop(),l=(0,d.iH)((0,d.cF)(),"paymentProof/".concat(m.I.currentUser.uid,"/").concat(i,"-").concat(n,".").concat(a));(0,d.KV)(l,s).then(async()=>{try{let e={};e.amount=t,e.fileExtension=a,e.uniqueId=n,await (0,c.Vx)((0,c.iH)(m.db,"payments/".concat(m.I.currentUser.uid,"/").concat(i)),e),Z({title:"Success",icon:"checkmark",children:"Payment has been successfully uploaded.",hidden:!1,mainText:"OK",mainColors:"bg-green-600",mainOnClick:()=>{Z({hidden:!0}),P.push("/payments")},secondaryShow:!1}),y(!1)}catch(e){Z({title:"Error.",icon:"error",children:"There was an error processing your payment. Please contact us if problem persists.",hidden:!1,mainText:"OK",mainColors:"bg-red-600",mainOnClick:()=>{Z({hidden:!0})},secondaryShow:!1}),w(!0),y(!1)}}).catch(e=>{Z({title:"Error.",icon:"error",children:"There was an error uploading your file. Please contact us if problem persists.",hidden:!1,mainText:"OK",mainColors:"bg-red-600",mainOnClick:()=>{Z({hidden:!0})},secondaryShow:!1}),w(!0),y(!1)})},{onlyOnce:!0})};return(0,n.jsxs)(a.Z,{title:"Add Payment",children:[(0,n.jsx)("div",{className:"flex min-h-full items-center justify-center px-4 sm:px-6 lg:px-8",children:(0,n.jsxs)("div",{className:"w-full space-y-8 max-w-md",children:[(0,n.jsx)("div",{children:(0,n.jsx)("h2",{className:"mt-6 text-center text-3xl font-bold tracking-tight text-gray-900",children:"Add Payment"})}),(0,n.jsx)("div",{className:"text-center text-sm",children:"string"==typeof s?s:s.map((e,t)=>(0,n.jsx)("p",{children:e},t))}),(0,n.jsxs)("form",{className:"space-y-6 w-full",onSubmit:j(_),noValidate:!0,children:[(0,n.jsx)("div",{className:"space-y-6",children:(0,n.jsxs)("div",{children:[(0,o.Z)({inputName:"Amount (".concat(p().currency,")"),placeholder:String(p().registration_fee),hook:b("amount",{required:"Amount is required",pattern:{value:g().amount,message:"Amount must be a number"},min:{value:1,message:"Amount must be at least 1"}}),errorMsg:null===(e=q.amount)||void 0===e?void 0:e.message}),(0,n.jsxs)("div",{className:"col-span-full",children:[(0,n.jsx)("label",{htmlFor:"cover-photo",className:"px-2 py-1",children:"Payment Proof"}),(0,n.jsx)("div",{className:"px-2 text-sm",children:null===(t=q.proof)||void 0===t?void 0:t.message}),k?(0,n.jsxs)("div",{className:"px-2 text-sm",children:["Uploaded: ",k[0].name,"."," ",(0,n.jsx)("div",{className:"inline-block font-semibold text-indigo-600 hover:text-indigo-500 hover:cursor-pointer",onClick:()=>Q("proof",null),children:"Remove"})]}):(0,n.jsx)("div",{className:"mt-2 flex justify-center rounded-lg border border-dashed border-gray-900/25 px-6 py-10",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsxs)("div",{className:"mt-4 flex text-sm leading-6 text-gray-600",children:[(0,n.jsxs)("label",{htmlFor:"proof",className:"relative cursor-pointer rounded-md bg-white font-semibold text-indigo-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-indigo-600 focus-within:ring-offset-2 hover:text-indigo-500",children:[(0,n.jsx)("span",{children:"Upload a file"}),(0,n.jsx)("input",{id:"proof",type:"file",className:"sr-only",...b("proof",{required:"Payment proof is required",validate:{lessThan3MB:e=>e&&e[0].size<3e6||"File must be less than 3MB",acceptedFormats:e=>e&&["image/png","image/jpeg","application/pdf"].includes(e[0].type)||"Unsupported Format",onlyOneFile:e=>e&&1===e.length||"Only one file is allowed"}})})]}),(0,n.jsx)("p",{className:"pl-1",children:"or drag and drop"})]}),(0,n.jsx)("p",{className:"text-xs leading-5 text-gray-600",children:"PNG, JPG, PDF up to 3MB"})]})})]})]})}),(0,n.jsx)(i.Z,{full:!0,props:{type:"submit"},isLoading:f,disabled:!v,children:"Submit Payment"})]})]})}),(0,x.Z)(T)]})}}},function(e){e.O(0,[627,257,414,536,650,584,888,774,179],function(){return e(e.s=6499)}),_N_E=e.O()}]);