(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[916],{4348:function(e,i,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/users/edit",function(){return l(3346)}])},4681:function(e,i,l){"use strict";l.d(i,{Z:function(){return n}});var r=l(5893);function n(e){let{title:i,hidden:l=!1,children:n,props:d}=e;return(0,r.jsxs)("div",{hidden:l,className:"space-y-2 rounded-md p-4 border-solid border-2 border-indigo-600",...d,children:[(0,r.jsx)("div",{className:"font-bold text-center text-xl",children:i}),n]})}},972:function(e,i,l){"use strict";l.d(i,{Z:function(){return n}});var r=l(5893);function n(e){let{children:i,id:l,disabled:n=!1,hook:d={},value:o}=e;return(0,r.jsxs)("div",{className:"flex space-x-2 p-1 text-sm font-bold "+(n?" text-gray-400":""),children:[(0,r.jsx)("input",{disabled:n,type:"radio",id:l,...d,className:"inline-block",value:void 0===o?l:o}),(0,r.jsx)("label",{className:"inline-block w-full",htmlFor:l,children:i})]})}},9954:function(e,i,l){"use strict";l.d(i,{Z:function(){return n}});var r=l(5893);function n(e){let{title:i,children:l,errorMsg:n}=e;return(0,r.jsxs)("div",{className:"space-y-0",children:[(0,r.jsxs)("div",{className:"px-2 py-1",children:[i," ",(0,r.jsx)("span",{className:"text-sm text-red-500",children:n})]}),l]})}},3346:function(e,i,l){"use strict";l.r(i),l.d(i,{default:function(){return b}});var r=l(5893),n=l(3067),d=l(8240),o=l(7294),s=l(7536),t=l(1481),a=l(1019),c=l(1259),u=l(4681),h=l(3188),m=l(972),g=l(9954),f=l(1664),v=l.n(f),x=l(130),p=l(1163);function b(){var e,i,l,f,b,y,j;let{register:k,formState:{errors:N},handleSubmit:S,setValue:Z}=(0,s.cI)(),[A,M]=(0,o.useState)(""),[w,C]=(0,o.useState)(!1),[I,P]=(0,o.useState)(!1),[_,F]=(0,o.useState)(""),E=(0,p.useRouter)(),[L,O]=(0,o.useReducer)(x.I,{}),[q,T]=(0,o.useState)({}),U=e=>{P(!0),C(!1);let i={};for(let l in e){if("nric"==l)continue;let r=l;(e[r]||"")!==(q[r]||"")&&(i[l]=e[r]?e[r]:"")}(0,a.Vx)((0,a.iU)((0,a.iH)(t.db),"users/"+A),i).then(()=>{P(!1),C(!0),O({hidden:!1,title:"Profile Updated Successfully",icon:"checkmark",mainText:"OK",mainOnClick:()=>{O({hidden:!0}),E.push({pathname:"/admin/users",query:{fetch:!0}})},mainColors:"bg-green-600",secondaryShow:!1})}).catch(e=>{console.log(e),P(!1),C(!0),O({hidden:!1,title:"Error",children:"An error occurred. Please try again later. If problem persists, please contact us.",icon:"error",mainText:"OK",mainOnClick:()=>{O({hidden:!0})},mainColors:"bg-red-600",secondaryShow:!1})})},[B,H]=(0,o.useState)(!1);(0,o.useEffect)(()=>{(0,c.Aj)(t.I,async e=>{var i;if(e&&(null==E?void 0:null===(i=E.query)||void 0===i?void 0:i.id)){if(B)return;H(!0);let{id:e}=E.query;if(!e)return;M(e),(0,a.jM)((0,a.iH)(t.db,"role/"+e),e=>{F(e.val())},{onlyOnce:!0}),(0,a.jM)((0,a.iU)((0,a.iH)(t.db),"users/"+e),e=>{for(let r in T(e.val()),console.log(e.val()),e.val()){var i,l;let n=r;i=r,(l=e.val()[n])&&(console.log(i,l),Z(i,l))}C(!0)},{onlyOnce:!0})}})});let K=e=>{let{hook:i,id:l,inputName:n,placeholder:d,children:o,errorMsg:s}=e;return(0,r.jsx)(h.Z,{hook:i,id:l,inputName:n,placeholder:d,disabled:!w,errorMsg:s,children:o})};return(0,r.jsxs)(d.Z,{children:[(0,r.jsx)("div",{className:"flex min-h-full items-center justify-center px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"w-full space-y-8 max-w-md",children:[(0,r.jsx)("div",{children:(0,r.jsxs)("h2",{className:"mt-6 text-center text-3xl font-bold tracking-tight text-gray-900",children:["Editing Profile: ",q.email]})}),(0,r.jsxs)("form",{className:"mt-8 space-y-6 w-full",onSubmit:S(U),noValidate:!0,children:["student"==_&&(0,r.jsx)(v(),{href:{pathname:"/admin/users/edit-nric",query:{id:A}},children:(0,r.jsx)(n.Z,{full:!0,children:"Edit NRIC"})}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(u.Z,{title:"Personal Information",children:[K({hook:k("name",{required:"Full name is required."}),id:"name",placeholder:"Full Name",errorMsg:null==N?void 0:null===(e=N.name)||void 0===e?void 0:e.message}),(0,r.jsxs)(g.Z,{title:"Gender",errorMsg:null==N?void 0:null===(i=N.gender)||void 0===i?void 0:i.message,children:[(0,r.jsx)(m.Z,{id:"male",hook:k("gender"),disabled:!w,children:"I am a Male"}),(0,r.jsx)(m.Z,{id:"female",hook:k("gender"),disabled:!w,children:"I am a Female"}),(0,r.jsx)(m.Z,{id:"undisclosed",hook:k("gender"),disabled:!w,children:"I am non-binary/I do not wish to disclose my gender"})]})]}),(0,r.jsxs)(u.Z,{title:"Student Information",hidden:"student"!=_,children:[K({hook:k("school"),id:"school",placeholder:"School",errorMsg:null==N?void 0:null===(l=N.school)||void 0===l?void 0:l.message}),K({hook:k("form",{validate:e=>"student"!=_||(!e||e.length<1?"Please fill in your form/year.":void 0)}),id:"name",inputName:"Form/Year",placeholder:"Form/Year (e.g. Form 4, Standard 6)",errorMsg:null==N?void 0:null===(f=N.form)||void 0===f?void 0:f.message}),K({hook:k("state"),id:"state",inputName:"State",placeholder:"State (e.g. Kuala Lumpur)",errorMsg:null==N?void 0:null===(b=N.state)||void 0===b?void 0:b.message}),K({hook:k("country",{validate:e=>"student"!=_||(!e||e.length<1?"Please fill in your country.":void 0)}),id:"country",inputName:"Country",placeholder:"Country (e.g. Malaysia)",errorMsg:null==N?void 0:null===(y=N.country)||void 0===y?void 0:y.message}),(0,r.jsxs)(g.Z,{title:"Category",errorMsg:null==N?void 0:null===(j=N.category)||void 0===j?void 0:j.message,children:[(0,r.jsx)(m.Z,{id:"junior",hook:k("category",{validate:e=>"student"!=_||(!e||e.length<1?"Please select a category.":void 0)}),disabled:!w,children:"Bongsu/Junior - Form 1, 2, 3, or Primary School"}),(0,r.jsx)(m.Z,{id:"intermediate",hook:k("category"),disabled:!w,children:"Muda/Intermediate - Form 4, 5"}),(0,r.jsx)(m.Z,{id:"senior",hook:k("category"),disabled:!w,children:"Sulung/Senior - Form 6 (lower & upper), Pre-U (Matriculation, Foundation Studies, IB, A-Levels, etc.)"})]})]}),(0,r.jsxs)(u.Z,{title:"Billing Information",hidden:"teacher"!=_&&"parent"!=_,children:[(0,r.jsx)("div",{className:"text-sm text-center",children:"This will be written on your receipt."}),K({hook:k("billingMobileNumber"),id:"billingMobileNumber",placeholder:"Mobile Number"}),K({hook:k("billingAddressLine1"),id:"billingAddressLine1",placeholder:"Address Line 1"}),K({hook:k("billingAddressLine2"),id:"billingAddressLine2",placeholder:"Address Line 2"}),K({hook:k("billingAddressPostcode"),id:"billingAddressPostcode",placeholder:"Postcode"}),K({hook:k("billingAddressCity"),id:"billingAddressCity",placeholder:"City"}),K({hook:k("billingAddressState"),id:"billingAddressState",placeholder:"State"}),K({hook:k("billingAddressCountry"),id:"billingAddressCountry",placeholder:"Country"})]}),(0,r.jsx)(n.Z,{props:{type:"submit"},isLoading:I,full:!0,children:"Update Details"})]})]})]})}),(0,x.Z)(L)]})}}},function(e){e.O(0,[627,18,273,536,669,774,888,179],function(){return e(e.s=4348)}),_N_E=e.O()}]);