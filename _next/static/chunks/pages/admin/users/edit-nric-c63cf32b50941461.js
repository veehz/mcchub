(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[329],{5682:function(a,n,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/users/edit-nric",function(){return e(6467)}])},1454:function(a,n,e){"use strict";e.d(n,{Z:function(){return s}});var i=e(5893);function s(a){let{children:n,id:e,disabled:s=!1,hook:r={},value:t}=a;return(0,i.jsxs)("div",{className:"flex space-x-2 p-1 text-sm font-bold "+(s?" text-gray-400":""),children:[(0,i.jsx)("input",{disabled:s,type:"radio",id:e,...r,className:"inline-block",value:void 0===t?e:t}),(0,i.jsx)("label",{className:"inline-block w-full",htmlFor:e,children:n})]})}},3706:function(a,n,e){"use strict";e.d(n,{Z:function(){return s}});var i=e(5893);function s(a){let{title:n,children:e,errorMsg:s}=a;return(0,i.jsxs)("div",{className:"space-y-0",children:[(0,i.jsxs)("div",{className:"px-2 py-1",children:[n," ",(0,i.jsx)("span",{className:"text-sm text-red-500",children:s})]}),e]})}},291:function(a){"use strict";a.exports=["Afghan","Albanian","Algerian","American","Andorran","Angolan","Anguillan","Citizen of Antigua and Barbuda","Argentine","Armenian","Australian","Austrian","Azerbaijani","Bahamian","Bahraini","Bangladeshi","Barbadian","Belarusian","Belgian","Belizean","Beninese","Bermudian","Bhutanese","Bolivian","Citizen of Bosnia and Herzegovina","Botswanan","Brazilian","British","British Virgin Islander","Bruneian","Bulgarian","Burkinan","Burmese","Burundian","Cambodian","Cameroonian","Canadian","Cape Verdean","Cayman Islander","Central African","Chadian","Chilean","Chinese","Colombian","Comoran","Congolese (Congo)","Congolese (DRC)","Cook Islander","Costa Rican","Croatian","Cuban","Cymraes","Cymro","Cypriot","Czech","Danish","Djiboutian","Dominican","Citizen of the Dominican Republic","Dutch","East Timorese","Ecuadorean","Egyptian","Emirati","English","Equatorial Guinean","Eritrean","Estonian","Ethiopian","Faroese","Fijian","Filipino","Finnish","French","Gabonese","Gambian","Georgian","German","Ghanaian","Gibraltarian","Greek","Greenlandic","Grenadian","Guamanian","Guatemalan","Citizen of Guinea-Bissau","Guinean","Guyanese","Haitian","Honduran","Hong Konger","Hungarian","Icelandic","Indian","Indonesian","Iranian","Iraqi","Irish","Israeli","Italian","Ivorian","Jamaican","Japanese","Jordanian","Kazakh","Kenyan","Kittitian","Citizen of Kiribati","Kosovan","Kuwaiti","Kyrgyz","Lao","Latvian","Lebanese","Liberian","Libyan","Liechtenstein citizen","Lithuanian","Luxembourger","Macanese","Macedonian","Malagasy","Malawian","Malaysian","Maldivian","Malian","Maltese","Marshallese","Martiniquais","Mauritanian","Mauritian","Mexican","Micronesian","Moldovan","Monegasque","Mongolian","Montenegrin","Montserratian","Moroccan","Mosotho","Mozambican","Namibian","Nauruan","Nepalese","New Zealander","Nicaraguan","Nigerian","Nigerien","Niuean","North Korean","Northern Irish","Norwegian","Omani","Pakistani","Palauan","Palestinian","Panamanian","Papua New Guinean","Paraguayan","Peruvian","Pitcairn Islander","Polish","Portuguese","Prydeinig","Puerto Rican","Qatari","Romanian","Russian","Rwandan","Salvadorean","Sammarinese","Samoan","Sao Tomean","Saudi Arabian","Scottish","Senegalese","Serbian","Citizen of Seychelles","Sierra Leonean","Singaporean","Slovak","Slovenian","Solomon Islander","Somali","South African","South Korean","South Sudanese","Spanish","Sri Lankan","St Helenian","St Lucian","Stateless","Sudanese","Surinamese","Swazi","Swedish","Swiss","Syrian","Taiwanese","Tajik","Tanzanian","Thai","Togolese","Tongan","Trinidadian","Tristanian","Tunisian","Turkish","Turkmen","Turks and Caicos Islander","Tuvaluan","Ugandan","Ukrainian","Uruguayan","Uzbek","Vatican citizen","Citizen of Vanuatu","Venezuelan","Vietnamese","Vincentian","Wallisian","Welsh","Yemeni","Zambian","Zimbabwean"]},432:function(a){"use strict";a.exports={nric:/[0-9]{2}[0-1][0-9][0-3][0-9]-[0-9]{2}-[0-9]{4}/,passport:/[A-Z0-9]{1,9}/,phone:/\+?[\d ]{1,6}[- ]?[\d ]{1,15}/,dob:/\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])/,email:/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/,amount:/\d+(\.\d{1,2})?/}},6467:function(a,n,e){"use strict";e.r(n),e.d(n,{default:function(){return v}});var i=e(5893),s=e(8804),r=e(7312),t=e(7294),l=e(7536),o=e(5696),u=e(1019),c=e(1259),d=e(1758),h=e(3706),m=e(1454),f=e(291),x=e.n(f),b=e(1365),p=e(1163),y=e(432),g=e.n(y);function v(){var a,n;let{register:e,handleSubmit:f,setValue:y,formState:{errors:v},watch:C}=(0,l.cI)({defaultValues:{isMalaysian:"null"}}),[N,S]=(0,t.useState)(!1),[M,k]=(0,t.useState)(!1),[j,w]=(0,t.useState)(!1),[P,I]=(0,t.useState)(""),z=C("isMalaysian"),[B,T]=(0,t.useState)(!1),[A,E]=(0,t.useState)(""),[R,G]=(0,t.useState)(!1),[H,O]=(0,t.useReducer)(b.I,{}),Z={title:"Error.",icon:"error",children:"There was an error. Please contact us if problem persists.",hidden:!1,mainText:"OK",mainColors:"bg-red-600",mainOnClick:()=>{O({hidden:!0})},secondaryShow:!1},K=(0,p.useRouter)(),_=async a=>{w(!0),k(!1);let n=a.nric?a.nric.trim():"",e=a.nationality?a.nationality.trim():"",i=a.passport?a.passport.trim():"";if("null"===z){O({...Z,children:"Please select user nationality."}),w(!1),k(!0);return}if("true"===z&&0===n.length){O({...Z,children:"Please enter user NRIC."}),w(!1),k(!0);return}if("false"===z&&0===e.length){O({...Z,children:"Please select user nationality."}),w(!1),k(!0);return}if("false"===z&&0===i.length){O({...Z,children:"Please enter user passport number."}),w(!1),k(!0);return}let s="true"===z?n:i;(0,u.jM)((0,u.iH)(o.db,"nric/"+s+"/student"),async a=>{if(a.val()){O({...Z,children:"NRIC/Passport Number is already taken. Please contact us if this is a mistake."}),w(!1);return}G(!0);try{await (0,u.t8)((0,u.iH)(o.db,"users/"+L+"/nationality"),"true"===z?"Malaysian":e),await (0,u.t8)((0,u.iH)(o.db,"users/"+L+"/nric"),s),await (0,u.t8)((0,u.iH)(o.db,"nric/"+s+"/student"),L),E(s),O({title:"Success!",icon:"checkmark",children:"Profile is successfully bound.",hidden:!1,mainText:"OK",mainColors:"bg-green-600",mainOnClick:()=>{O({hidden:!0}),K.reload()},secondaryShow:!1}),T(!0),w(!1),k(!1)}catch(a){O({...Z,children:"There was an error. Please contact us if problem persists."}),w(!1),k(!0);return}},{onlyOnce:!0})},[L,V]=(0,t.useState)(""),[U,q]=(0,t.useState)("");return(0,t.useEffect)(()=>{(0,c.Aj)(o.I,async a=>{var n;if(!R&&a&&(null==K?void 0:null===(n=K.query)||void 0===n?void 0:n.id)){if(N)return;S(!0);let{id:a}=K.query;if(!a)return;V(a),(0,u.jM)((0,u.iH)(o.db,"role/"+a),a=>{q(a.val())},{onlyOnce:!0}),(0,u.jM)((0,u.iH)(o.db,"users/"+a+"/nric"),n=>{let e=n.val();E(e),e?(T(!0),(0,u.jM)((0,u.iH)(o.db,"users/"+a+"/nationality"),a=>{y("nationality",a.val());let n="Malaysian"===a.val();y("isMalaysian",n?"true":"false"),n?y("nric",e):y("passport",e),I(["An indentification is already bound to user account.","If you want to change user identification, please contact us."])},{onlyOnce:!0})):(T(!1),(0,u.jM)((0,u.iH)(o.db,"role/"+a),a=>{q(a.val()),"student"===a.val()?(k(!0),I(["You can bind user identification only once.","Please check before submitting."])):I(["You are not a student. You don't have to bind user IC number.","Please contact us if this is a mistake."])}))},{onlyOnce:!0})}})}),(0,i.jsxs)(r.Z,{title:"Edit User Identification",children:[(0,i.jsx)("div",{className:"flex min-h-full items-center justify-center px-4 sm:px-6 lg:px-8",children:(0,i.jsxs)("div",{className:"w-full space-y-8 max-w-md",children:[(0,i.jsx)("div",{children:(0,i.jsx)("h2",{className:"mt-6 text-center text-3xl font-bold tracking-tight text-gray-900",children:"Bind NRIC/Passport Number"})}),(0,i.jsx)("div",{className:"text-center text-sm",children:"string"==typeof P?P:P.map((a,n)=>(0,i.jsx)("p",{children:a},n))}),(0,i.jsxs)(h.Z,{children:[(0,i.jsx)(m.Z,{id:"malaysian",value:"true",hook:e("isMalaysian"),disabled:!M,children:"Malaysian"}),(0,i.jsx)(m.Z,{id:"nonmalaysian",value:"false",hook:e("isMalaysian"),disabled:!M,children:"Non-Malaysian"})]}),(0,i.jsx)("form",{className:"space-y-6 w-full",onSubmit:f(_),noValidate:!0,children:(0,i.jsxs)("div",{className:"space-y-2",children:["false"===z?(0,i.jsxs)("div",{className:"w-full",children:[(0,i.jsx)("div",{className:"px-2 py-1",children:(0,i.jsx)("label",{children:"Nationality"})}),(0,i.jsxs)("select",{className:"rounded-md relative block w-full border-0 py-1.5 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:z-10 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6 disabled:opacity-75 disabled:bg-slate-100",disabled:!M,id:"nationality",defaultValue:"select-one",...e("nationality",{validate:{notEmpty:a=>"select-one"!=a||"Please select user nationality"}}),children:[(0,i.jsx)("option",{value:"select-one",disabled:!0,children:"Select user nationality"}),x().filter(a=>"Malaysian"!=a).map((a,n)=>(0,i.jsx)("option",{value:a,children:a},n))]})]}):null,"true"===z?(0,d.Z)({hook:e("nric",{pattern:{value:g().nric,message:"Invalid NRIC format."}}),id:"nric",inputName:"NRIC",placeholder:"NRIC with dashes (e.g. 031231-14-1234)",disabled:!M,errorMsg:null==v?void 0:null===(a=v.nric)||void 0===a?void 0:a.message}):null,"false"===z?(0,d.Z)({hook:e("passport",{pattern:{value:g().passport,message:"Invalid Passport format. Passports should only contain uppercase letters and numbers. If this is not the case for your passport number, please contact us."}}),id:"nric",inputName:"Passport Number",placeholder:"Passport Number (e.g. A1234567)",disabled:!M,errorMsg:null==v?void 0:null===(n=v.passport)||void 0===n?void 0:n.message}):null,(0,i.jsx)(s.Z,{full:!0,props:{type:"submit"},isLoading:j,disabled:!M,children:"Bind NRIC/Passport Number"})]})}),"student"==U&&(0,i.jsx)(s.Z,{full:!0,onClick:()=>{let a={};a["users/"+L+"/nric"]=null,a["users/"+L+"/nationality"]=null,a["nric/"+A+"/student"]=null,(0,u.Vx)((0,u.iH)(o.db),a).then(()=>{O({title:"Success!",icon:"checkmark",children:"Profile is successfully unbound.",hidden:!1,mainText:"OK",mainColors:"bg-green-600",mainOnClick:()=>{O({hidden:!0}),K.reload()},secondaryShow:!1})}).catch(a=>{O({title:"Error",icon:"error",children:"Unbound unsuccessful.",hidden:!1,mainText:"OK",mainColors:"bg-red-600",mainOnClick:()=>{O({hidden:!0}),K.reload()},secondaryShow:!1})})},children:"Unbind NRIC/Passport Number"})]})}),(0,b.Z)(H)]})}}},function(a){a.O(0,[627,257,414,536,634,888,774,179],function(){return a(a.s=5682)}),_N_E=a.O()}]);