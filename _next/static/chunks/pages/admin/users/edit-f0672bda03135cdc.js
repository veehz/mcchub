(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[916],{4348:function(e,i,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/users/edit",function(){return t(5343)}])},3758:function(e,i,t){"use strict";t.d(i,{Z:function(){return l}});var s=t(5893);function l(e){let{title:i,hidden:t=!1,children:l,props:r}=e;return(0,s.jsxs)("div",{hidden:t,className:"space-y-2 rounded-md p-4 border-solid border-2 border-indigo-600",...r,children:[(0,s.jsx)("div",{className:"font-bold text-center text-xl",children:i}),l]})}},1454:function(e,i,t){"use strict";t.d(i,{Z:function(){return l}});var s=t(5893);function l(e){let{children:i,id:t,disabled:l=!1,hook:r={},value:n}=e;return(0,s.jsxs)("div",{className:"flex space-x-2 p-1 text-sm font-bold "+(l?" text-gray-400":""),children:[(0,s.jsx)("input",{disabled:l,type:"radio",id:t,...r,className:"inline-block",value:void 0===n?t:n}),(0,s.jsx)("label",{className:"inline-block w-full",htmlFor:t,children:i})]})}},3706:function(e,i,t){"use strict";t.d(i,{Z:function(){return l}});var s=t(5893);function l(e){let{title:i,children:t,errorMsg:l}=e;return(0,s.jsxs)("div",{className:"space-y-0",children:[(0,s.jsxs)("div",{className:"px-2 py-1",children:[i," ",(0,s.jsx)("span",{className:"text-sm text-red-500",children:l})]}),t]})}},1365:function(e,i,t){"use strict";t.d(i,{I:function(){return l},Z:function(){return r}});var s=t(5893);function l(e,i){return{...e,...i}}function r(e){let{title:i,icon:t,children:l,className:r,hidden:n=!0,mainText:d="OK",mainColors:o,mainOnClick:a,secondaryText:c="Cancel",secondaryShow:u=!0,secondaryColors:m,secondaryOnClick:h}=e,x={checkmark:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"48",viewBox:"0 96 960 960",width:"48",children:(0,s.jsx)("path",{className:"fill-green-300",d:"m421 667-98-98q-9-9-22-9t-23 10q-9 9-9 22t9 22l122 123q9 9 21 9t21-9l239-239q10-10 10-23t-10-23q-10-9-23.5-8.5T635 453L421 667Zm59 309q-82 0-155-31.5t-127.5-86Q143 804 111.5 731T80 576q0-83 31.5-156t86-127Q252 239 325 207.5T480 176q83 0 156 31.5T763 293q54 54 85.5 127T880 576q0 82-31.5 155T763 858.5q-54 54.5-127 86T480 976Z"})}),error:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"48",viewBox:"0 96 960 960",width:"48",children:(0,s.jsx)("path",{className:"fill-red-300",d:"M479.754 801Q504 801 519.5 786.246q15.5-14.755 15.5-39Q535 723 519.746 707q-15.255-16-39.5-16Q456 691 440.5 706.982 425 722.965 425 747.211q0 24.245 15.254 39.017Q455.509 801 479.754 801Zm3.421-177Q503 624 516.5 610.375 530 596.75 530 577V401q0-19.75-13.675-33.375Q502.649 354 482.825 354 463 354 449.5 367.625 436 381.25 436 401v176q0 19.75 13.675 33.375Q463.351 624 483.175 624Zm-2.771 377q-88.872 0-166.125-33.084-77.254-33.083-135.183-91.012-57.929-57.929-91.012-135.119Q55 664.594 55 575.638q0-88.957 33.084-166.285 33.083-77.328 90.855-134.809 57.772-57.482 135.036-91.013Q391.238 150 480.279 150q89.04 0 166.486 33.454 77.446 33.453 134.853 90.802 57.407 57.349 90.895 134.877Q906 486.66 906 575.734q0 89.01-33.531 166.247-33.531 77.237-91.013 134.86-57.481 57.623-134.831 90.891Q569.276 1001 480.404 1001Z"})}),warning:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"48",viewBox:"0 96 960 960",width:"48",children:(0,s.jsx)("path",{className:"fill-yellow-300",d:"M100 949q-14.483 0-24.98-6.925Q64.521 935.15 59 925q-6.167-9.6-6.583-22.381Q52 889.839 59 877l380-656q7-12 18.103-17.5 11.102-5.5 23-5.5Q492 198 503 203.5q11 5.5 18 17.5l380 656q7 12.839 6.583 25.619Q907.167 915.4 901 925q-5.696 9.75-16.106 16.875Q874.483 949 860 949H100Zm384.175-132q13.4 0 23.613-10.388Q518 796.224 518 782.825q0-13.4-10.388-23.112Q497.224 750 483.825 750q-13.4 0-23.613 9.888Q450 769.776 450 783.175q0 13.4 10.388 23.612Q470.776 817 484.175 817Zm0-109q12.825 0 21.325-8.625T514 678V522q0-12.75-8.675-21.375-8.676-8.625-21.5-8.625-12.825 0-21.325 8.625T454 522v156q0 12.75 8.675 21.375 8.676 8.625 21.5 8.625Z"})}),notif:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"48",viewBox:"0 96 960 960",width:"48",children:(0,s.jsx)("path",{className:"fill-blue-300",d:"M480.281 621Q494 621 503 611.8q9-9.2 9-22.8V450q0-12.6-9.281-21.8-9.28-9.2-23-9.2-13.719 0-22.219 9.2-8.5 9.2-8.5 21.8v139q0 13.6 8.993 22.8 8.993 9.2 22.288 9.2Zm-.299 107q14.593 0 25.806-10.982Q517 706.035 517 691.518 517 677 505.805 666t-25.787-11q-14.593 0-25.806 11.079Q443 677.158 443 691.579T454.195 717q11.195 11 25.787 11ZM165.44 878q-21.19 0-34.815-13.675-13.625-13.676-13.625-34Q117 810 130.625 796.5 144.25 783 165 783h45V505q0-92.085 53.5-167.542Q317 262 407 241.583V218q0-30.5 21.223-50.75T479.765 147q30.318 0 51.777 20.25Q553 187.5 553 218v23.583Q644 262 698 337.458 752 412.915 752 505v278h44q19.625 0 33.812 13.675 14.188 13.676 14.188 34Q844 851 829.812 864.5 815.625 878 796 878H165.44Zm315.06 123q-35.45 0-61.975-25.85T392 913h177q0 37-26.231 62.5-26.232 25.5-62.269 25.5Z"})})};return(0,s.jsxs)("div",{className:"relative z-10 "+r,"aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",hidden:n,children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"}),(0,s.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,s.jsx)("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:(0,s.jsxs)("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg",children:[(0,s.jsx)("div",{className:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4",children:(0,s.jsxs)("div",{className:"sm:flex sm:items-start",children:[(0,s.jsx)("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full sm:mx-0 sm:h-10 sm:w-10",children:t?"string"==typeof t&&x[t]?x[t]:t:null}),(0,s.jsxs)("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left",children:[(0,s.jsx)("h3",{className:"text-base font-semibold leading-6 text-gray-900",id:"modal-title",children:i}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)("div",{className:"text-sm text-gray-500",children:l})})]})]})}),(0,s.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:[(0,s.jsx)("button",{type:"button",className:"inline-flex w-full justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:opacity-80 sm:ml-3 sm:w-auto "+o,onClick:a,children:d}),(0,s.jsx)("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:opacity-80 sm:mt-0 sm:w-auto "+m,hidden:!u,onClick:h,children:c})]})]})})})]})}},5343:function(e,i,t){"use strict";t.r(i),t.d(i,{default:function(){return w}});var s=t(5893),l=t(8804),r=t(7312),n=t(7294),d=t(7536),o=t(5696),a=t(1019),c=t(1259),u=t(3758),m=t(1758),h=t(1454),x=t(3706),g=t(1664),f=t.n(g),v=t(1365),p=t(1163),y=t(8063),b=t.n(y),j=t(4023);function w(){var e,i,t,g,y,w,q;let{register:N,formState:{errors:k},handleSubmit:Q,setValue:Z}=(0,d.cI)(),[S,C]=(0,n.useState)(""),[M,A]=(0,n.useState)(!1),[T,P]=(0,n.useState)(!1),[_,I]=(0,n.useState)(""),E=(0,p.useRouter)(),[F,L]=(0,n.useReducer)(v.I,{}),[O,B]=(0,n.useState)({}),[V,K]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(0,c.Aj)(o.I,async e=>{var i;if(e&&(null==E?void 0:null===(i=E.query)||void 0===i?void 0:i.id)){if(V)return;K(!0);let{id:e}=E.query;if(!e)return;C(e),(0,j.cY)(e).then(e=>{I(e)}),(0,j.M_)(e).then(e=>{for(let i in B(e),e)Z(i,e[i]);A(!0)})}})});let U=e=>{let{hook:i,id:t,inputName:l,placeholder:r,children:n,errorMsg:d}=e;return(0,s.jsx)(m.Z,{hook:i,id:t,inputName:l,placeholder:r,disabled:!M,errorMsg:d,children:n})},H=b().genders;return(0,s.jsxs)(r.Z,{title:"Edit Profile",children:[(0,s.jsx)("div",{className:"flex min-h-full items-center justify-center px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"w-full space-y-8 max-w-md",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("h2",{className:"mt-6 text-center text-3xl font-bold tracking-tight text-gray-900",children:["Editing Profile: ",O.email]})}),(0,s.jsxs)("form",{className:"mt-8 space-y-6 w-full",onSubmit:Q(e=>{P(!0),A(!1);let i={};for(let t in e)"nric"!=t&&(e[t]||"")!==(O[t]||"")&&(i[t]=e[t]?e[t]:"");(0,a.Vx)((0,a.iU)((0,a.iH)(o.db),"users/"+S),i).then(()=>{P(!1),A(!0),L({hidden:!1,title:"Profile Updated Successfully",icon:"checkmark",mainText:"OK",mainOnClick:()=>{L({hidden:!0}),E.push({pathname:"/admin/users",query:{fetch:!0}})},mainColors:"bg-green-600",secondaryShow:!1})}).catch(e=>{P(!1),A(!0),L({hidden:!1,title:"Error",children:"An error occurred. Please try again later. If problem persists, please contact us.",icon:"error",mainText:"OK",mainOnClick:()=>{L({hidden:!0})},mainColors:"bg-red-600",secondaryShow:!1})})}),noValidate:!0,children:["student"==_&&(0,s.jsx)(f(),{href:{pathname:"/admin/users/edit-nric",query:{id:S}},children:(0,s.jsx)(l.Z,{full:!0,children:"Edit NRIC"})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(u.Z,{title:"Personal Information",children:[U({hook:N("name",{required:"Full name is required."}),id:"name",placeholder:"Full Name",errorMsg:null==k?void 0:null===(e=k.name)||void 0===e?void 0:e.message}),(0,s.jsx)(x.Z,{title:"Gender",errorMsg:null==k?void 0:null===(i=k.gender)||void 0===i?void 0:i.message,children:Object.keys(H).map(e=>(0,s.jsx)(h.Z,{id:e,hook:N("gender"),disabled:!M,children:H[e]},e))})]}),(0,s.jsxs)(u.Z,{title:"Student Information",hidden:"student"!=_,children:[U({hook:N("school"),id:"school",placeholder:"School",errorMsg:null==k?void 0:null===(t=k.school)||void 0===t?void 0:t.message}),U({hook:N("form",{validate:e=>"student"!=_||(!e||e.length<1?"Please fill in your form/year.":void 0)}),id:"name",inputName:"Form/Year",placeholder:"Form/Year (e.g. Form 4, Standard 6)",errorMsg:null==k?void 0:null===(g=k.form)||void 0===g?void 0:g.message}),U({hook:N("state"),id:"state",inputName:"State",placeholder:"State (e.g. Kuala Lumpur)",errorMsg:null==k?void 0:null===(y=k.state)||void 0===y?void 0:y.message}),U({hook:N("country",{validate:e=>"student"!=_||(!e||e.length<1?"Please fill in your country.":void 0)}),id:"country",inputName:"Country",placeholder:"Country (e.g. Malaysia)",errorMsg:null==k?void 0:null===(w=k.country)||void 0===w?void 0:w.message}),(0,s.jsxs)(x.Z,{title:"Category",errorMsg:null==k?void 0:null===(q=k.category)||void 0===q?void 0:q.message,children:[(0,s.jsx)(h.Z,{id:"junior",hook:N("category",{validate:e=>"student"!=_||(!e||e.length<1?"Please select a category.":void 0)}),disabled:!M,children:"Bongsu/Junior - Form 1, 2, 3, or Primary School"}),(0,s.jsx)(h.Z,{id:"intermediate",hook:N("category"),disabled:!M,children:"Muda/Intermediate - Form 4, 5"}),(0,s.jsx)(h.Z,{id:"senior",hook:N("category"),disabled:!M,children:"Sulung/Senior - Form 6 (lower & upper), Pre-U (Matriculation, Foundation Studies, IB, A-Levels, etc.)"})]})]}),(0,s.jsxs)(u.Z,{title:"Billing Information",hidden:"teacher"!=_&&"parent"!=_,children:[(0,s.jsx)("div",{className:"text-sm text-center",children:"This will be written on your receipt."}),U({hook:N("billingMobileNumber"),id:"billingMobileNumber",placeholder:"Mobile Number"}),U({hook:N("billingAddressLine1"),id:"billingAddressLine1",placeholder:"Address Line 1"}),U({hook:N("billingAddressLine2"),id:"billingAddressLine2",placeholder:"Address Line 2"}),U({hook:N("billingAddressPostcode"),id:"billingAddressPostcode",placeholder:"Postcode"}),U({hook:N("billingAddressCity"),id:"billingAddressCity",placeholder:"City"}),U({hook:N("billingAddressState"),id:"billingAddressState",placeholder:"State"}),U({hook:N("billingAddressCountry"),id:"billingAddressCountry",placeholder:"Country"})]}),(0,s.jsx)(l.Z,{props:{type:"submit"},isLoading:T,full:!0,children:"Update Details"})]})]})]})}),(0,v.Z)(F)]})}}},function(e){e.O(0,[627,257,414,536,584,888,774,179],function(){return e(e.s=4348)}),_N_E=e.O()}]);